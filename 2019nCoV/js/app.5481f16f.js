(function(e){var t={};function n(o){if(t[o])return t[o].exports;var r=t[o]={i:o,l:!1,exports:{}};return e[o].call(r.exports,r,r.exports,n),r.l=!0,r.exports}n.m=e,n.c=t,n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},n.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(o,r,function(t){return e[t]}.bind(null,r));return o},n.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="/2019nCoV/",n(n.s=0)})({0:function(e,t,n){e.exports=n("56d7")},"56d7":function(e,t,n){"use strict";n.r(t);var o=n("8bbf"),r=n.n(o),i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"app"}},[n("Main")],1)},a=[],s=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("el-row",[n("el-col",{attrs:{span:12}},[e._v(" 【国内】请选择省、市（默认显示江苏省南通）： "),n("el-cascader-panel",{attrs:{options:e.domesticCascaderOptions},on:{change:e.handleChangeDomestic}})],1),n("el-col",{attrs:{span:12}},[e._v(" 【国外】请选择洲、国（默认显示亚洲中国）： "),n("el-cascader-panel",{attrs:{options:e.foreignCascaderOptions},on:{change:e.handleChangeForeign}})],1)],1),n("div",[e._v("截至 "+e._s(e.lastUpdateTime)+" 数据统计")]),n("div",{staticStyle:{width:"500px",height:"400px"},attrs:{id:"main"}})],1)},c=[],u=n("5f72"),l=n.n(u),p=n("eb11"),d="累计确诊",f="治愈",m="死亡",h="疑似",v="现存确诊",C={name:"Main",props:{},data:()=>({default:{provinceName:"江苏省",cityName:"南通"},lastUpdateTime:"--",db:{},nCoVData:[],_collection:null,provinceNames:[],domesticCascaderOptions:[],foreignCascaderOptions:[],test:null,dbUrl:"https://3.test.xy-jit.cc/DXYArea.csv"}),methods:{loadDataset:function(){return axios.get(this.dbUrl).then(e=>{this.db=e.data})},handleChangeDomestic:function(e){var[t,n]=e;this.updateFigure("亚洲","中国",t,n),console.log(e)},handleChangeForeign:function(e){var[t,n]=e;this.updateFigure(t,n,"全国","全省"),console.log(e)},fetchNCoVData:function(){this.nCoVData=this.parseCsv(this.db),this._collection=collect(this.nCoVData).sortBy("updateTime"),this.lastUpdateTime=this._collection.last().updateTime,this.lastUpdateTime=this.formatTimestamp(this.lastUpdateTime,"YYYY-MM-DD HH:mm:ss")},fetchProvinceNames:function(){this.provinceName=new Set(this.nCoVData.map(e=>e.provinceName))},prepareCascaderOptions:function(){var e=[{value:"全国",label:"全国"}].concat(this._collection.filter((e,t)=>"中国"===e.countryName&&"中国"!==e.provinceName&&!!e.provinceName&&!!e.cityName).groupBy("provinceName").filter((e,t)=>!!t).map((e,t)=>({value:t,label:t,children:[{value:"全省",label:"全省"}].concat(e.unique("cityName").map(e=>({value:e.cityName,label:e.cityName})).values().all())})).values().all()),t=[].concat(this._collection.filter((e,t)=>!e.cityName).groupBy("continentName").filter((e,t)=>!!t).map((e,t)=>({value:t,label:t,children:[].concat(e.groupBy("countryName").filter((e,t)=>!!t).map((e,t)=>({value:t,label:t})).values().all())})).values().all());this.domesticCascaderOptions=e,this.foreignCascaderOptions=t},formatTimestamp:function(e,t="YYYY-MM-DD"){return moment(e).format(t)},parseCsv:function(e,t=",",n="\n",o=!0){var r=0;o&&(r=1);for(var i=e.split(n),a=[],s=r;s<i.length;s++){var c=i[s].split(t),[u,l,p,d,f,m,h,v,C,y,_,g,b,w,N,T,O,x,A]=c;f&&a.push({continentName:u,countryName:p,provinceName:f,cityName:b,province_confirmedCount:parseInt(v),province_suspectedCount:parseInt(C),province_curedCount:parseInt(y),province_deadCount:parseInt(_),city_confirmedCount:parseInt(T),city_suspectedCount:parseInt(O),city_curedCount:parseInt(x),city_deadCount:parseInt(A),updateTime:moment(g,"YYYY-MM-DD HH:mm:ss.SSS").valueOf()})}return a},makeSeries:function(e){var t=function(e,t){return e.map(e=>e[t])};return[{name:d,type:"line",data:t(e,"confirmedCount")},{name:f,type:"line",data:t(e,"curedCount")},{name:m,type:"line",data:t(e,"deadCount")},{name:h,type:"line",data:t(e,"suspectedCount")},{name:v,type:"line",data:t(e,"remainCount")}]},makeEchartOption:function(e,t,n){return{title:{text:e},tooltip:{},legend:{data:[d,f,m,h,v]},xAxis:{data:t},yAxis:{},series:this.makeSeries(n)}},makeAllProvinceData:function(e="中国"){var t=this,n=t._collection.filter((t,n)=>t.countryName===e&&"中国"!==t.provinceName).groupBy((e,n)=>t.formatTimestamp(e.updateTime)).filter((e,t)=>!!t).map(e=>{var t=e.groupBy("provinceName"),n=t.sum(e=>e.first().province_confirmedCount),o=t.sum(e=>e.first().province_curedCount),r=t.sum(e=>e.first().province_deadCount),i=t.sum(e=>e.first().province_suspectedCount),a=n-o;return{confirmedCount:n,curedCount:o,deadCount:r,suspectedCount:i,remainCount:a}});return this.test=n,[n.keys().all(),n.values().all()]},makeProvinceData:function(e="江苏省"){var t=this,n=collect(t.nCoVData).filter((t,n)=>t.provinceName===e).sortBy("updateTime").groupBy((e,n)=>t.formatTimestamp(e.updateTime)).filter((e,t)=>!!t).map(e=>{var t=e.first();return{confirmedCount:t.province_confirmedCount,curedCount:t.province_curedCount,deadCount:t.province_deadCount,suspectedCount:t.province_suspectedCount,remainCount:t.province_confirmedCount-t.province_curedCount}});return this.test=n,[n.keys().all(),n.values().all()]},makeCityData:function(e="江苏省",t="南通"){var n=this,o=collect(n.nCoVData).filter((n,o)=>n.provinceName===e&&n.cityName===t).sortBy("updateTime").groupBy((e,t)=>n.formatTimestamp(e.updateTime)).filter((e,t)=>!!t).map(e=>{var t=e.first();return{confirmedCount:t.city_confirmedCount,curedCount:t.city_curedCount,deadCount:t.city_deadCount,suspectedCount:t.city_suspectedCount,remainCount:t.city_confirmedCount-t.city_curedCount}});return this.test=o,[o.keys().all(),o.values().all()]},initFigure:function(){this.figure=echarts.init(document.getElementById("main"))},updateFigure:function(e="亚洲",t="中国",n="江苏省",o="南通"){var r,i,a="疫情：\n"+e+t+n;"全国"===n?[r,i]=this.makeAllProvinceData(t):"全省"===o?(a+=o,[r,i]=this.makeProvinceData(n)):(a+=o,[r,i]=this.makeCityData(n,o));var s=this.makeEchartOption(a,r,i);this.figure.setOption(s)}},created:function(){},mounted:async function(){const e=this.$loading({lock:!0,text:"数据加载中...",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.7)"});this.initFigure();var t=JSON.parse(localStorage.getItem("db")),n=t?t.updateTime:0,o=moment.now()>moment(n).valueOf()+72e5;console.log("isTwoHoursLater",o),o?await this.loadDataset():this.db=Object(p["decompress"])(t.data),e.close(),this.fetchNCoVData(),this.prepareCascaderOptions(),this.fetchProvinceNames(),this.updateFigure(this.default.provinceName,this.default.cityName)}},y=C;function _(e,t,n,o,r,i,a,s){var c,u="function"===typeof e?e.options:e;if(t&&(u.render=t,u.staticRenderFns=n,u._compiled=!0),o&&(u.functional=!0),i&&(u._scopeId="data-v-"+i),a?(c=function(e){e=e||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext,e||"undefined"===typeof __VUE_SSR_CONTEXT__||(e=__VUE_SSR_CONTEXT__),r&&r.call(this,e),e&&e._registeredComponents&&e._registeredComponents.add(a)},u._ssrRegister=c):r&&(c=s?function(){r.call(this,(u.functional?this.parent:this).$root.$options.shadowRoot)}:r),c)if(u.functional){u._injectStyles=c;var l=u.render;u.render=function(e,t){return c.call(t),l(e,t)}}else{var p=u.beforeCreate;u.beforeCreate=p?[].concat(p,c):[c]}return{exports:e,options:u}}var g=_(y,s,c,!1,null,"5abc2194",null),b=g.exports,w={name:"App",components:{Main:b}},N=w,T=_(N,i,a,!1,null,null,null),O=T.exports;r.a.use(l.a),r.a.config.productionTip=!1,new r.a({render:function(e){return e(O)}}).$mount("#app")},"5f72":function(e,t){e.exports=ELEMENT},"8bbf":function(e,t){e.exports=Vue},eb11:function(e,t,n){var o,r=function(){var e=String.fromCharCode,t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+-$",o={};function r(e,t){if(!o[e]){o[e]={};for(var n=0;n<e.length;n++)o[e][e.charAt(n)]=n}return o[e][t]}var i={compressToBase64:function(e){if(null==e)return"";var n=i._compress(e,6,(function(e){return t.charAt(e)}));switch(n.length%4){default:case 0:return n;case 1:return n+"===";case 2:return n+"==";case 3:return n+"="}},decompressFromBase64:function(e){return null==e?"":""==e?null:i._decompress(e.length,32,(function(n){return r(t,e.charAt(n))}))},compressToUTF16:function(t){return null==t?"":i._compress(t,15,(function(t){return e(t+32)}))+" "},decompressFromUTF16:function(e){return null==e?"":""==e?null:i._decompress(e.length,16384,(function(t){return e.charCodeAt(t)-32}))},compressToUint8Array:function(e){for(var t=i.compress(e),n=new Uint8Array(2*t.length),o=0,r=t.length;o<r;o++){var a=t.charCodeAt(o);n[2*o]=a>>>8,n[2*o+1]=a%256}return n},decompressFromUint8Array:function(t){if(null===t||void 0===t)return i.decompress(t);for(var n=new Array(t.length/2),o=0,r=n.length;o<r;o++)n[o]=256*t[2*o]+t[2*o+1];var a=[];return n.forEach((function(t){a.push(e(t))})),i.decompress(a.join(""))},compressToEncodedURIComponent:function(e){return null==e?"":i._compress(e,6,(function(e){return n.charAt(e)}))},decompressFromEncodedURIComponent:function(e){return null==e?"":""==e?null:(e=e.replace(/ /g,"+"),i._decompress(e.length,32,(function(t){return r(n,e.charAt(t))})))},compress:function(t){return i._compress(t,16,(function(t){return e(t)}))},_compress:function(e,t,n){if(null==e)return"";var o,r,i,a={},s={},c="",u="",l="",p=2,d=3,f=2,m=[],h=0,v=0;for(i=0;i<e.length;i+=1)if(c=e.charAt(i),Object.prototype.hasOwnProperty.call(a,c)||(a[c]=d++,s[c]=!0),u=l+c,Object.prototype.hasOwnProperty.call(a,u))l=u;else{if(Object.prototype.hasOwnProperty.call(s,l)){if(l.charCodeAt(0)<256){for(o=0;o<f;o++)h<<=1,v==t-1?(v=0,m.push(n(h)),h=0):v++;for(r=l.charCodeAt(0),o=0;o<8;o++)h=h<<1|1&r,v==t-1?(v=0,m.push(n(h)),h=0):v++,r>>=1}else{for(r=1,o=0;o<f;o++)h=h<<1|r,v==t-1?(v=0,m.push(n(h)),h=0):v++,r=0;for(r=l.charCodeAt(0),o=0;o<16;o++)h=h<<1|1&r,v==t-1?(v=0,m.push(n(h)),h=0):v++,r>>=1}p--,0==p&&(p=Math.pow(2,f),f++),delete s[l]}else for(r=a[l],o=0;o<f;o++)h=h<<1|1&r,v==t-1?(v=0,m.push(n(h)),h=0):v++,r>>=1;p--,0==p&&(p=Math.pow(2,f),f++),a[u]=d++,l=String(c)}if(""!==l){if(Object.prototype.hasOwnProperty.call(s,l)){if(l.charCodeAt(0)<256){for(o=0;o<f;o++)h<<=1,v==t-1?(v=0,m.push(n(h)),h=0):v++;for(r=l.charCodeAt(0),o=0;o<8;o++)h=h<<1|1&r,v==t-1?(v=0,m.push(n(h)),h=0):v++,r>>=1}else{for(r=1,o=0;o<f;o++)h=h<<1|r,v==t-1?(v=0,m.push(n(h)),h=0):v++,r=0;for(r=l.charCodeAt(0),o=0;o<16;o++)h=h<<1|1&r,v==t-1?(v=0,m.push(n(h)),h=0):v++,r>>=1}p--,0==p&&(p=Math.pow(2,f),f++),delete s[l]}else for(r=a[l],o=0;o<f;o++)h=h<<1|1&r,v==t-1?(v=0,m.push(n(h)),h=0):v++,r>>=1;p--,0==p&&(p=Math.pow(2,f),f++)}for(r=2,o=0;o<f;o++)h=h<<1|1&r,v==t-1?(v=0,m.push(n(h)),h=0):v++,r>>=1;while(1){if(h<<=1,v==t-1){m.push(n(h));break}v++}return m.join("")},decompress:function(e){return null==e?"":""==e?null:i._decompress(e.length,32768,(function(t){return e.charCodeAt(t)}))},_decompress:function(t,n,o){var r,i,a,s,c,u,l,p=[],d=4,f=4,m=3,h="",v=[],C={val:o(0),position:n,index:1};for(r=0;r<3;r+=1)p[r]=r;a=0,c=Math.pow(2,2),u=1;while(u!=c)s=C.val&C.position,C.position>>=1,0==C.position&&(C.position=n,C.val=o(C.index++)),a|=(s>0?1:0)*u,u<<=1;switch(a){case 0:a=0,c=Math.pow(2,8),u=1;while(u!=c)s=C.val&C.position,C.position>>=1,0==C.position&&(C.position=n,C.val=o(C.index++)),a|=(s>0?1:0)*u,u<<=1;l=e(a);break;case 1:a=0,c=Math.pow(2,16),u=1;while(u!=c)s=C.val&C.position,C.position>>=1,0==C.position&&(C.position=n,C.val=o(C.index++)),a|=(s>0?1:0)*u,u<<=1;l=e(a);break;case 2:return""}p[3]=l,i=l,v.push(l);while(1){if(C.index>t)return"";a=0,c=Math.pow(2,m),u=1;while(u!=c)s=C.val&C.position,C.position>>=1,0==C.position&&(C.position=n,C.val=o(C.index++)),a|=(s>0?1:0)*u,u<<=1;switch(l=a){case 0:a=0,c=Math.pow(2,8),u=1;while(u!=c)s=C.val&C.position,C.position>>=1,0==C.position&&(C.position=n,C.val=o(C.index++)),a|=(s>0?1:0)*u,u<<=1;p[f++]=e(a),l=f-1,d--;break;case 1:a=0,c=Math.pow(2,16),u=1;while(u!=c)s=C.val&C.position,C.position>>=1,0==C.position&&(C.position=n,C.val=o(C.index++)),a|=(s>0?1:0)*u,u<<=1;p[f++]=e(a),l=f-1,d--;break;case 2:return v.join("")}if(0==d&&(d=Math.pow(2,m),m++),p[l])h=p[l];else{if(l!==f)return null;h=i+i.charAt(0)}v.push(h),p[f++]=i+h.charAt(0),d--,i=h,0==d&&(d=Math.pow(2,m),m++)}}};return i}();o=function(){return r}.call(t,n,t,e),void 0===o||(e.exports=o)}});